---
title: Catalan number 卡塔兰数
date: 2024-04-03 09:55:00 +0800
categories: [Mathematics, Statistics]
tags: [组合数, 卡塔兰数, 有趣]     # TAG names should always be lowercase
math: true
---


## 1. 背景

在组合数学中，卡塔兰数（Catalan numbers）是出现在各种计数问题中的自然数序列，它们以法国-比利时数学家Eugène Charles Catalan的名字命名。

## 2. 符号和计算方法

与高中学的组合数（有时称作二项式系数）符号 $C_n^i$形式不同，卡塔兰数只有下标$n$, 表示对于n个数据的问题的组合种类数

第n个Catalan数可以直接用中心二项式系数表示为：

$$C_n=\frac1{n+1}\binom{2n}n=\frac{(2n)!}{(n+1)!n!}=\prod_{k=2}^n\frac{n+k}k\quad\mathrm{for~}n\geq0.$$

例如：n = 0, 1, 2, 3 , ... 的Catalan数，分别是：
1, 1, 2, 5, 14, 42, 132, ...

## 3. 组合数学中的应用

组合数学中有许多计数问题的解是由Catalan数给出的。组合学家理查德·P·斯坦利（Richard P. Stanley）的《枚举组合学：第二卷》（Enumerative Combinatorics：Volume 2）一书中包含了一组练习，描述了66种对加泰罗尼亚数字的不同解释。下面举一些常见的例子：

**1. 因子完全括号化的方式数**
$C_n$ 是 n + 1 个因子可以被完全括号化的不同方式的数量（或者是将二元运算符的n个应用相关联的方式的数量，如在矩阵链乘法问题中）。例如，对于n = 3，我们有以下四个因子的五种不同括号: 
$((ab)c)d$    $(a(bc))d$    $(ab)(cd)$    $a((bc)d)$   $a(b(cd))$

**2. 有n+1片叶子的二叉树的组合数**
二元运算符的连续应用可以通过标记每个叶子a，b，c，d来表示为完整的二叉树。因此，$C_n$ 是具有n + 1个叶子的完整二叉树的数量，或者等价地，具有总共n个内部节点：
![[Pasted image 20240321201334.png]]

**3. 有n\*n个正方形单元网格的单调晶格路径的数量**
$C_n$ 是沿着具有n × n个正方形单元的网格的边缘的单调晶格路径的数量，这些路径不通过对角线上方。单调路径是从左下角开始，在右上角结束，并且完全由指向右或向上的边组成的路径。计算这样的路径相当于计算戴克单词：X代表“向右移动”，Y代表“向上移动”。n=4时：
![[Pasted image 20240321201744.png]]

## 4. 一种证明

（对应上述应用3）
给定一条单调路径，路径的长度定义为对角线上垂直边的个数。例如，在下图中，对角线上方的边用红色标记，因此此路径的超出率为5。
![[Pasted image 20240321204254.png]]

给定一条单调路径，它的超出率不为零，我们应用下面的算法来构造一条新的路径，它的秩比我们开始时的路径小1。

- 从左下角开始，沿着路径走，直到它第一次走到对角线上方。
- 继续沿着这条路走，直到它再次碰到对角线。用X表示到达的第一个这样的边缘。
- 将路径中X之前的部分与X之后的部分交换。

![[Pasted image 20240321204439.png]]

超出率从3降到了2。实际上，该算法会导致我们输入的任何路径的重复性减少1，因为在对角线上开始的第一个垂直步骤（在用黑点标记的点处）是唯一的垂直边，当我们应用该算法时，从对角线上方变为对角线下方-所有其他垂直边都保持在对角线的同一侧。

可以看出，这个过程是可逆的：给定任何路径P，其重复次数小于n，当算法应用于它时，正好有一条路径产生P。实际上，（黑色）边缘X，最初是在对角线上结束的第一个水平步骤，已经成为在对角线上开始的最后一个水平步骤。或者，反转原始算法以查找通过对角线下方的第一条边。

这意味着，重复次数n的路径数等于重复次数n-1的路径数，重复次数n-1的路径数等于重复次数n-2的路径数，依此类推，直到零。换句话说，我们已经将所有单调路径的集合分成n + 1个相等大小的类，对应于0和n之间可能的距离。由于存在 ![{\displaystyle \textstyle {2n \choose n}}](https://wikimedia.org/api/rest_v1/media/math/render/svg/4a334a538420fdef7c072b34de7b03826201ade1) 条单调路径，我们得到期望的公式: ![{\displaystyle \textstyle C_{n}={\frac {1}{n+1}}{2n \choose n}.}](https://wikimedia.org/api/rest_v1/media/math/render/svg/ce7f0549d2f863ad02ee5ff83d728c5d0a20d344)

![[Pasted image 20240321204737.png]]

图4说明了n = 3的情况。20条可能的单调路径中的每一条都出现在表中的某个地方。第一列显示了所有的路径，这些路径完全位于对角线上方。右边的列显示了连续应用算法的结果，其中超出率每次减少一个单位。有5行，即C 3 = 5，最后一列显示不高于对角线的所有路径。

## 5. 与矩阵的联系

**Hankel matix (汉克尔矩阵)**
如果n×n汉克尔矩阵的（i, j）项是Catalan数 $C_{i+j-2}$，则它的行列式为1，与n的值无关。对于n = 4，我们有:
$$\det\begin{bmatrix}1&1&2&5\\1&2&5&14\\2&5&14&42\\5&14&42&132\end{bmatrix}=1.$$
此外，如果索引被“移位”，使得（i,j）元素被加泰罗尼亚数 $C_{i+j-1}$ 填充，则行列式仍然是1，而不管n的值如何。对于n = 4，我们有:
$$\det\begin{bmatrix}1&2&5&14\\2&5&14&42\\5&14&42&132\\14&42&132&429\end{bmatrix}=1.$$
这两个条件一起唯一地定义了Catalan数。

Catalan-Hankel矩阵的另一个独特的特征是从2开始的n×n子矩阵的行列式具有行列式n + 1。
$$\begin{aligned}
&\det\left[2\right]=2 \\
&\det\begin{bmatrix}2&5\\5&14\end{bmatrix}=3 \\
&\left.\det\left[\begin{array}{ccc}2&5&14\\5&14&42\\14&42&132\end{array}\right.\right]=4 \\
&\det\begin{bmatrix}2&5&14&42\\5&14&42&132\\14&42&132&429\\42&132&429&1430\end{bmatrix}=5& \text{.} 
\end{aligned}$$
